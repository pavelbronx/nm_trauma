<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∞—à–±–æ—Ä–¥ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        h2 {
            color: #3498db;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        h3 {
            color: #2c3e50;
        }
        h4 {
            color: #3498db;
            margin-top: 20px;
        }
        .input-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select, textarea {
            padding: 8px;
            width: 200px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        textarea {
            width: 100%;
            height: 80px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .stats-section {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .stat-card {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            flex: 1;
            margin: 0 10px;
            min-width: 200px;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        .criteria-section {
            margin-bottom: 30px;
        }
        .criteria-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .criteria-card {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .criteria-list {
            list-style-type: none;
            padding: 0;
        }
        .criteria-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .criteria-list li:last-child {
            border-bottom: none;
        }
        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .chart-container {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            height: 300px;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .ai-assistant {
            background-color: #f0f8ff;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .ai-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .ai-icon {
            font-size: 24px;
            margin-right: 10px;
            color: #3498db;
        }
        .ai-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .ai-controls textarea {
            flex-grow: 1;
        }
        .ai-response {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            min-height: 150px;
            border: 1px solid #ddd;
        }
        .suggestion {
            font-style: italic;
            color: #666;
            margin-top: 10px;
            font-size: 14px;
        }
        .ai-charts {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        .ai-chart-container {
            background-color: white;
            border-radius: 5px;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            height: 250px;
            text-align: center;
        }
        .dynamic-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        @media (max-width: 768px) {
            .charts-section, .criteria-grid, .ai-charts, .dynamic-charts {
                grid-template-columns: 1fr;
            }
            .stats-section {
                flex-direction: column;
            }
            .stat-card {
                margin: 10px 0;
            }
            .ai-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–î–∞—à–±–æ—Ä–¥ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h1>
        <p>–ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–∫–∞–∑–∞ 203–ù –æ—Ç 10 –º–∞—è 2017 –≥–æ–¥–∞, –∫–æ–¥—ã –ú–ö–ë-10: S02.0; S06; S07.1; S07.8</p>
        
        <div class="input-section">
            <div class="input-group">
                <label for="periodSelector">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥:</label>
                <select id="periodSelector" onchange="updateDashboard()">
                    <option value="year" selected>–ó–∞ –≥–æ–¥</option>
                    <option value="10302">–Ø–Ω–≤–∞—Ä—å 2025</option>
                    <option value="9530">–§–µ–≤—Ä–∞–ª—å 2025</option>
                    <option value="2489">–ú–∞—Ä—Ç 2025</option>
                    <option value="3763">–ê–ø—Ä–µ–ª—å 2025</option>
                    <option value="5673">–ú–∞–π 2025</option>
                    <option value="2376">–ò—é–Ω—å 2025</option>
                    <option value="5376">–ò—é–ª—å 2025</option>
                    <option value="6859">–ê–≤–≥—É—Å—Ç 2025</option>
                    <option value="8666">–°–µ–Ω—Ç—è–±—Ä—å 2025</option>
                    <option value="5664">–û–∫—Ç—è–±—Ä—å 2025</option>
                </select>
                <button onclick="updateDashboard()">–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </div>
        </div>
        
        <div class="stats-section">
            <div class="stat-card">
                <h3>–í—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h3>
                <div class="stat-value" id="totalValue">55,494</div>
            </div>
            <div class="stat-card">
                <h3>–° –æ—à–∏–±–∫–∞–º–∏</h3>
                <div class="stat-value" id="errorsValue">3,304</div>
            </div>
            <div class="stat-card">
                <h3>–£—Å–ø–µ—à–Ω—ã—Ö</h3>
                <div class="stat-value" id="successValue">52,190</div>
            </div>
            <div class="stat-card">
                <h3>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫</h3>
                <div class="stat-value" id="errorPercentage">6.0%</div>
            </div>
        </div>
        
        <div class="criteria-section">
            <h2>–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –ø. 3.18.1 –ü—Ä–∏–∫–∞–∑–∞ 203–ù</h2>
            <div class="criteria-grid">
                <div class="criteria-card">
                    <h3>–û–±—â–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
                    <ul class="criteria-list">
                        <li>–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –æ–∫–∞–∑–∞–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏</li>
                        <li>–ü–æ–ª–Ω–æ—Ç–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –æ—Å–º–æ—Ç—Ä–∞ –∏ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</li>
                        <li>–û–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∏–∞–≥–Ω–æ–∑–∞</li>
                        <li>–ê–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è</li>
                        <li>–û—Ü–µ–Ω–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ä–∏—Å–∫–∞ –∏ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</li>
                        <li>–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</li>
                        <li>–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–µ—á–µ–Ω–∏—è</li>
                        <li>–ù–∞–ª–∏—á–∏–µ –ø–ª–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è</li>
                    </ul>
                </div>
                <div class="criteria-card">
                    <h3>–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è —Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏–∏</h3>
                    <ul class="criteria-list">
                        <li>–û—Ü–µ–Ω–∫–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Ç—Ä–∞–≤–º—ã</li>
                        <li>–û—Ü–µ–Ω–∫–∞ –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –ß–ú–¢</li>
                        <li>–û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–∑–Ω–∞–Ω–∏—è –ø–æ —à–∫–∞–ª–µ –ì–ª–∞–∑–≥–æ</li>
                        <li>–û—Ü–µ–Ω–∫–∞ –≤–∏—Ç–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π</li>
                        <li>–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</li>
                        <li>–û—Ü–µ–Ω–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏</li>
                        <li>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–≥–æ –æ–±–µ–∑–±–æ–ª–∏–≤–∞–Ω–∏—è</li>
                        <li>–û—Ü–µ–Ω–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="charts-section">
            <div class="chart-container">
                <canvas id="pieChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="barChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="criteriaPerformanceChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="documentationQualityChart"></canvas>
            </div>
        </div>
        
        <div class="dynamic-charts">
            <div class="chart-container">
                <canvas id="documentsDynamicChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="errorsDynamicChart"></canvas>
            </div>
        </div>
        
        <h2>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞</h2>
        <div class="table-container">
            <table id="criteriaTable">
                <thead>
                    <tr>
                        <th>–ö—Ä–∏—Ç–µ—Ä–∏–π –∫–∞—á–µ—Å—Ç–≤–∞</th>
                        <th>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</th>
                        <th>–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</th>
                        <th>% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã JavaScript -->
                </tbody>
            </table>
        </div>
        
        <h2>–ö–∞—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º</h2>
        <div class="table-container">
            <table id="documentationTable">
                <thead>
                    <tr>
                        <th>–ö—Ä–∏—Ç–µ—Ä–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</th>
                        <th>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç</th>
                        <th>–ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç</th>
                        <th>% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã JavaScript -->
                </tbody>
            </table>
        </div>
        
        <!-- –ë–ª–æ–∫ AI-–ø–æ–º–æ—â–Ω–∏–∫–∞ -->
        <div class="ai-assistant">
            <div class="ai-header">
                <div class="ai-icon">ü§ñ</div>
                <h2>AI-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤</h2>
            </div>
            <p>–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞. –ù–∞–ø—Ä–∏–º–µ—Ä: "—Å–æ–∑–¥–∞–π –æ—Ç—á–µ—Ç –ø–æ —Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞"</p>
            
            <div class="ai-controls">
                <textarea id="aiQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∑–¥–µ—Å—å...">—Å–æ–∑–¥–∞–π –æ—Ç—á–µ—Ç –ø–æ —Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞</textarea>
                <button onclick="generateReport()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç</button>
            </div>
            
            <div class="suggestion">
                –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å "—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è" –Ω–∞: –°–°–ó, –æ–Ω–∫–æ–ª–æ–≥–∏—è, –ø–µ–¥–∏–∞—Ç—Ä–∏—è –∏–ª–∏ –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—è
            </div>
            
            <div class="ai-response" id="aiResponse">
                –û—Ç—á–µ—Ç –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        let totalDocuments = 55494; // –°—É–º–º–∞ –∑–∞ –≥–æ–¥
        let totalErrors = 3304; // –°—É–º–º–∞ –æ—à–∏–±–æ–∫ –∑–∞ –≥–æ–¥
        
        // –î–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º
        const monthlyData = {
            labels: ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å', '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å'],
            documents: [10302, 9530, 2489, 3763, 5673, 2376, 5376, 6859, 8666, 5664],
            errorRates: [5, 8, 3, 13, 11, 2, 5, 6, 8, 4],
            errors: [515, 762, 75, 489, 624, 48, 269, 412, 693, 227] // –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –æ—à–∏–±–æ–∫
        };
        
        // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø–æ –∫–æ–¥–∞–º –ú–ö–ë –ø–æ –º–µ—Å—è—Ü–∞–º
        const monthlyErrorsByCode = {
            '10302': { // –Ø–Ω–≤–∞—Ä—å - –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                'S02.0': 24,
                'S06': 48,
                'S07.1': 84,
                'S07.8': 132
            },
            '9530': { // –§–µ–≤—Ä–∞–ª—å - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 4%
                'S02.0': 25,
                'S06': 50,
                'S07.1': 87,
                'S07.8': 137
            },
            '2489': { // –ú–∞—Ä—Ç - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 4%
                'S02.0': 26,
                'S06': 52,
                'S07.1': 91,
                'S07.8': 143
            },
            '3763': { // –ê–ø—Ä–µ–ª—å - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 4%
                'S02.0': 27,
                'S06': 54,
                'S07.1': 95,
                'S07.8': 149
            },
            '5673': { // –ú–∞–π - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 4%
                'S02.0': 28,
                'S06': 56,
                'S07.1': 99,
                'S07.8': 155
            },
            '2376': { // –ò—é–Ω—å - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 4%
                'S02.0': 29,
                'S06': 58,
                'S07.1': 103,
                'S07.8': 161
            },
            '5376': { // –ò—é–ª—å - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 4%
                'S02.0': 30,
                'S06': 60,
                'S07.1': 107,
                'S07.8': 167
            },
            '6859': { // –ê–≤–≥—É—Å—Ç - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 8%
                'S02.0': 28,
                'S06': 55,
                'S07.1': 98,
                'S07.8': 154
            },
            '8666': { // –°–µ–Ω—Ç—è–±—Ä—å - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 8%
                'S02.0': 26,
                'S06': 51,
                'S07.1': 90,
                'S07.8': 142
            },
            '5664': { // –û–∫—Ç—è–±—Ä—å - —É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 8%
                'S02.0': 24,
                'S06': 47,
                'S07.1': 83,
                'S07.8': 131
            }
        };
        
        // –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–∫–∞–∑—É 203–ù
        const qualityCriteria = [
            "–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –æ–∫–∞–∑–∞–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏",
            "–ü–æ–ª–Ω–æ—Ç–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –æ—Å–º–æ—Ç—Ä–∞ –∏ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è",
            "–û–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∏–∞–≥–Ω–æ–∑–∞",
            "–ê–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è",
            "–û—Ü–µ–Ω–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ä–∏—Å–∫–∞ –∏ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π",
            "–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π",
            "–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–µ—á–µ–Ω–∏—è",
            "–ù–∞–ª–∏—á–∏–µ –ø–ª–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è"
        ];
        
        const documentationCriteria = [
            "–ü–æ–ª–Ω–æ—Ç–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏",
            "–°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
            "–ù–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è",
            "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∏–∞–≥–Ω–æ–∑–∞ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º",
            "–ù–∞–ª–∏—á–∏–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è",
            "–û—Ç—Ä–∞–∂–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞",
            "–ù–∞–ª–∏—á–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø—Ä–∏ –≤—ã–ø–∏—Å–∫–µ",
            "–ü–æ–ª–Ω–æ—Ç–∞ —ç–ø–∏–∫—Ä–∏–∑–∞"
        ];
        
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
        const medicalDirections = {
            —Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è: {
                title: "—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏–∏",
                criteriaParagraph: "–ø. 3.18.1",
                errorRate: { min: 10, max: 25 },
                criteriaRates: { min: 70, max: 90 },
                documentationRates: { min: 65, max: 85 },
                monthlyDocs: 5549, // –°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                specificCriteria: [
                    "–û—Ü–µ–Ω–∫–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Ç—Ä–∞–≤–º—ã",
                    "–û—Ü–µ–Ω–∫–∞ –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –ß–ú–¢",
                    "–û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–∑–Ω–∞–Ω–∏—è –ø–æ —à–∫–∞–ª–µ –ì–ª–∞–∑–≥–æ",
                    "–û—Ü–µ–Ω–∫–∞ –≤–∏—Ç–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π",
                    "–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"
                ],
                commonProblems: [
                    "–Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–∞–∑–∞–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏",
                    "–Ω–µ–ø–æ–ª–Ω—ã–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä",
                    "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ü–µ–Ω–∫–∏ –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –ß–ú–¢"
                ]
            },
            —Å—Å–∑: {
                title: "–±–æ–ª–µ–∑–Ω—è–º —Å–∏—Å—Ç–µ–º—ã –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏—è",
                criteriaParagraph: "–ø. 3.5",
                errorRate: { min: 8, max: 20 },
                criteriaRates: { min: 75, max: 92 },
                documentationRates: { min: 70, max: 88 },
                monthlyDocs: 6200,
                specificCriteria: [
                    "–û—Ü–µ–Ω–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ä–∏—Å–∫–∞ —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π",
                    "–ö–æ–Ω—Ç—Ä–æ–ª—å –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è",
                    "–û—Ü–µ–Ω–∫–∞ –ª–∏–ø–∏–¥–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è",
                    "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞–Ω—Ç–∏–∞–≥—Ä–µ–≥–∞–Ω—Ç–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏",
                    "–û—Ü–µ–Ω–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–∞—Ç–∏–Ω–æ—Ç–µ—Ä–∞–ø–∏–∏"
                ],
                commonProblems: [
                    "–Ω–µ–ø–æ–ª–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ä–∏—Å–∫–∞",
                    "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è",
                    "–Ω–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞–Ω—Ç–∏–∞–≥—Ä–µ–≥–∞–Ω—Ç–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏ –ø—Ä–∏ –ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö"
                ]
            },
            –æ–Ω–∫–æ–ª–æ–≥–∏—è: {
                title: "–æ–Ω–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º",
                criteriaParagraph: "–ø. 3.10",
                errorRate: { min: 5, max: 15 },
                criteriaRates: { min: 80, max: 95 },
                documentationRates: { min: 75, max: 90 },
                monthlyDocs: 4800,
                specificCriteria: [
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞–¥–∏–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–æ TNM",
                    "–û—Ü–µ–Ω–∫–∞ –≥–∏—Å—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è",
                    "–ü–ª–∞–Ω –ø—Ä–æ—Ç–∏–≤–æ–æ–ø—É—Ö–æ–ª–µ–≤–æ–≥–æ –ª–µ—á–µ–Ω–∏—è",
                    "–û—Ü–µ–Ω–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π –∫ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–º—É –ª–µ—á–µ–Ω–∏—é",
                    "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Ç–µ—Ä–∞–ø–∏–∏"
                ],
                commonProblems: [
                    "–Ω–µ–ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞–¥–∏–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è",
                    "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–ª–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è",
                    "–Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –æ–Ω–∫–æ–ª–æ–≥–∞"
                ]
            },
            –ø–µ–¥–∏–∞—Ç—Ä–∏—è: {
                title: "–ø–µ–¥–∏–∞—Ç—Ä–∏–∏",
                criteriaParagraph: "–ø. 3.16",
                errorRate: { min: 12, max: 28 },
                criteriaRates: { min: 68, max: 88 },
                documentationRates: { min: 62, max: 85 },
                monthlyDocs: 7200,
                specificCriteria: [
                    "–û—Ü–µ–Ω–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–µ–±–µ–Ω–∫–∞",
                    "–û—Ü–µ–Ω–∫–∞ –Ω–µ—Ä–≤–Ω–æ-–ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è",
                    "–£—á–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π",
                    "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–≤–∏–≤–æ–∫",
                    "–û—Ü–µ–Ω–∫–∞ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–º–Ω–µ–∑–∞"
                ],
                commonProblems: [
                    "–Ω–µ–ø–æ–ª–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è",
                    "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—á–µ—Ç–∞ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –¥–æ–∑–∏—Ä–æ–≤–æ–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤",
                    "–Ω–µ–ø–æ–ª–Ω—ã–π –∞–Ω–∞–º–Ω–µ–∑ –∂–∏–∑–Ω–∏ —Ä–µ–±–µ–Ω–∫–∞"
                ]
            },
            –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—è: {
                title: "–≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏–∏",
                criteriaParagraph: "–ø. 3.15",
                errorRate: { min: 7, max: 18 },
                criteriaRates: { min: 72, max: 90 },
                documentationRates: { min: 70, max: 87 },
                monthlyDocs: 5800,
                specificCriteria: [
                    "–û—Ü–µ–Ω–∫–∞ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏",
                    "–û—Ü–µ–Ω–∫–∞ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–º–Ω–µ–∑–∞",
                    "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –æ—Å–º–æ—Ç—Ä–∞",
                    "–û—Ü–µ–Ω–∫–∞ –¥–∞–Ω–Ω—ã—Ö –£–ó–ò –æ—Ä–≥–∞–Ω–æ–≤ –º–∞–ª–æ–≥–æ —Ç–∞–∑–∞",
                    "–ü–ª–∞–Ω –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö —Ü–∏–∫–ª–∞"
                ],
                commonProblems: [
                    "–Ω–µ–ø–æ–ª–Ω—ã–π –≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–º–Ω–µ–∑",
                    "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ü–µ–Ω–∫–∏ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏",
                    "–Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –£–ó–ò"
                ]
            }
        };
        
        // –°—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const periodSelector = document.getElementById('periodSelector');
        const totalValue = document.getElementById('totalValue');
        const errorsValue = document.getElementById('errorsValue');
        const successValue = document.getElementById('successValue');
        const errorPercentage = document.getElementById('errorPercentage');
        const criteriaTableBody = document.querySelector('#criteriaTable tbody');
        const documentationTableBody = document.querySelector('#documentationTable tbody');
        const aiQuery = document.getElementById('aiQuery');
        const aiResponse = document.getElementById('aiResponse');
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –≥—Ä–∞—Ñ–∏–∫–æ–≤
        let pieChart, barChart, criteriaPerformanceChart, documentationQualityChart;
        let documentsDynamicChart, errorsDynamicChart;
        let aiCharts = []; // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º –≤ –æ—Ç—á–µ—Ç–µ AI
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–µ–¥–µ–ª—è–º
        function generateWeeklyData(totalDocs, totalErrors) {
            const weeks = 4;
            const documents = [];
            const errors = [];
            const errorRates = [];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–µ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Å—É–º–º–µ –¥–∞—é—Ç totalDocs
            let remainingDocs = totalDocs;
            let remainingErrors = totalErrors;
            
            for (let i = 0; i < weeks - 1; i++) {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –Ω–µ–¥–µ–ª–∏ (–æ—Ç 20% –¥–æ 40% –æ—Ç –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è)
                const maxDocs = Math.min(remainingDocs, Math.floor(remainingDocs * 0.4));
                const minDocs = Math.floor(remainingDocs * 0.2);
                const weekDocs = Math.floor(Math.random() * (maxDocs - minDocs + 1)) + minDocs;
                documents.push(weekDocs);
                remainingDocs -= weekDocs;
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ –¥–ª—è –Ω–µ–¥–µ–ª–∏ (–æ—Ç 50% –¥–æ 150% –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞)
                const avgErrorRate = (totalErrors / totalDocs) * 100;
                const minErrorRate = avgErrorRate * 0.5;
                const maxErrorRate = Math.min(avgErrorRate * 1.5, 20); // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç 20%
                const weekErrorRate = Math.random() * (maxErrorRate - minErrorRate) + minErrorRate;
                errorRates.push(weekErrorRate);
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –¥–ª—è –Ω–µ–¥–µ–ª–∏
                const weekErrors = Math.round(weekDocs * weekErrorRate / 100);
                errors.push(weekErrors);
                remainingErrors -= weekErrors;
            }
            
            // –ü–æ—Å–ª–µ–¥–Ω—è—è –Ω–µ–¥–µ–ª—è –ø–æ–ª—É—á–∞–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –æ—à–∏–±–∫–∏
            documents.push(remainingDocs);
            const lastWeekErrorRate = (remainingErrors / remainingDocs) * 100;
            errorRates.push(lastWeekErrorRate);
            errors.push(remainingErrors);
            
            return {
                labels: ['1 –Ω–µ–¥–µ–ª—è', '2 –Ω–µ–¥–µ–ª—è', '3 –Ω–µ–¥–µ–ª—è', '4 –Ω–µ–¥–µ–ª—è'],
                documents: documents,
                errors: errors,
                errorRates: errorRates.map(rate => parseFloat(rate.toFixed(1)))
            };
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –ø–æ –∫–æ–¥–∞–º –ú–ö–ë –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
        function getErrorsByCode(selectedValue) {
            if (selectedValue === "year") {
                // –î–ª—è –≥–æ–¥–∞ —Å—É–º–º–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø–æ –≤—Å–µ–º –º–µ—Å—è—Ü–∞–º
                const yearlyErrors = {
                    'S02.0': 0,
                    'S06': 0,
                    'S07.1': 0,
                    'S07.8': 0
                };
                
                Object.values(monthlyErrorsByCode).forEach(monthErrors => {
                    yearlyErrors['S02.0'] += monthErrors['S02.0'];
                    yearlyErrors['S06'] += monthErrors['S06'];
                    yearlyErrors['S07.1'] += monthErrors['S07.1'];
                    yearlyErrors['S07.8'] += monthErrors['S07.8'];
                });
                
                return yearlyErrors;
            } else {
                // –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                return monthlyErrorsByCode[selectedValue] || {
                    'S02.0': 0,
                    'S06': 0,
                    'S07.1': 0,
                    'S07.8': 0
                };
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –∫–∞—á–µ—Å—Ç–≤–∞
        function generateCriteriaData(total, direction) {
            const criteriaData = {};
            const directionData = medicalDirections[direction] || medicalDirections.—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è;
            
            qualityCriteria.forEach(criterion => {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
                const complianceRate = Math.floor(Math.random() * 
                    (directionData.criteriaRates.max - directionData.criteriaRates.min + 1)) + 
                    directionData.criteriaRates.min;
                const compliantCount = Math.round(total * complianceRate / 100);
                
                criteriaData[criterion] = {
                    compliant: compliantCount,
                    nonCompliant: total - compliantCount,
                    complianceRate: complianceRate
                };
            });
            
            return criteriaData;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
        function generateDocumentationData(total, direction) {
            const documentationData = {};
            const directionData = medicalDirections[direction] || medicalDirections.—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è;
            
            documentationCriteria.forEach(criterion => {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
                const complianceRate = Math.floor(Math.random() * 
                    (directionData.documentationRates.max - directionData.documentationRates.min + 1)) + 
                    directionData.documentationRates.min;
                const compliantCount = Math.round(total * complianceRate / 100);
                
                documentationData[criterion] = {
                    compliant: compliantCount,
                    nonCompliant: total - compliantCount,
                    complianceRate: complianceRate
                };
            });
            
            return documentationData;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
        function detectDirection(query) {
            const lowerQuery = query.toLowerCase();
            
            if (lowerQuery.includes("—Å—Å–∑") || lowerQuery.includes("—Å–µ—Ä–¥") || lowerQuery.includes("–∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω")) {
                return "—Å—Å–∑";
            } else if (lowerQuery.includes("–æ–Ω–∫–æ–ª–æ–≥–∏")) {
                return "–æ–Ω–∫–æ–ª–æ–≥–∏—è";
            } else if (lowerQuery.includes("–ø–µ–¥–∏–∞—Ç—Ä") || lowerQuery.includes("–¥–µ—Ç—Å–∫")) {
                return "–ø–µ–¥–∏–∞—Ç—Ä–∏—è";
            } else if (lowerQuery.includes("–≥–∏–Ω–µ–∫–æ–ª–æ–≥") || lowerQuery.includes("–±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç") || lowerQuery.includes("—Ä–æ–¥")) {
                return "–≥–∏–Ω–µ–∫–æ–ª–æ–≥–∏—è";
            } else if (lowerQuery.includes("—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥")) {
                return "—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è";
            }
            
            return "—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è"; // –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Å—è—Ü–µ–≤ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
        function detectMonths(query) {
            const lowerQuery = query.toLowerCase();
            const monthMatch = lowerQuery.match(/(\d+)\s*–º–µ—Å—è—Ü/);
            
            if (monthMatch && monthMatch[1]) {
                return parseInt(monthMatch[1]);
            }
            
            // –ï—Å–ª–∏ –º–µ—Å—è—Ü –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            return 3;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞
        function updateDashboard() {
            // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
            const selectedValue = periodSelector.value;
            
            if (selectedValue === "year") {
                // –ó–∞ –≥–æ–¥
                totalDocuments = monthlyData.documents.reduce((sum, value) => sum + value, 0);
                totalErrors = monthlyData.errors.reduce((sum, value) => sum + value, 0);
            } else {
                // –ó–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–µ—Å—è—Ü
                totalDocuments = parseInt(selectedValue);
                // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å –º–µ—Å—è—Ü–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
                const monthIndex = monthlyData.documents.indexOf(totalDocuments);
                if (monthIndex !== -1) {
                    totalErrors = monthlyData.errors[monthIndex];
                } else {
                    // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –ø—Ä–æ—Ü–µ–Ω—Ç—É
                    totalErrors = Math.round(totalDocuments * 6 / 100);
                }
            }
            
            const successCount = totalDocuments - totalErrors;
            const errorPercent = ((totalErrors / totalDocuments) * 100).toFixed(1);
            
            // –ü–æ–ª—É—á–∞–µ–º –æ—à–∏–±–∫–∏ –ø–æ –∫–æ–¥–∞–º –ú–ö–ë –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
            const errorsByCode = getErrorsByCode(selectedValue);
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
            const criteriaData = generateCriteriaData(totalDocuments, "—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è");
            const documentationData = generateDocumentationData(totalDocuments, "—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥–∏—è");
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            totalValue.textContent = totalDocuments.toLocaleString('ru-RU');
            errorsValue.textContent = totalErrors.toLocaleString('ru-RU');
            successValue.textContent = successCount.toLocaleString('ru-RU');
            errorPercentage.textContent = `${errorPercent}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—ã
            updateTables(criteriaData, documentationData);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
            updateCharts(totalErrors, successCount, criteriaData, documentationData, selectedValue, errorsByCode);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü
        function updateTables(criteriaData, documentationData) {
            // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã
            criteriaTableBody.innerHTML = '';
            documentationTableBody.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞
            qualityCriteria.forEach(criterion => {
                const data = criteriaData[criterion];
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${criterion}</td>
                    <td>${data.compliant.toLocaleString('ru-RU')}</td>
                    <td>${data.nonCompliant.toLocaleString('ru-RU')}</td>
                    <td>${data.complianceRate}%</td>
                `;
                
                criteriaTableBody.appendChild(row);
            });
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
            documentationCriteria.forEach(criterion => {
                const data = documentationData[criterion];
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${criterion}</td>
                    <td>${data.compliant.toLocaleString('ru-RU')}</td>
                    <td>${data.nonCompliant.toLocaleString('ru-RU')}</td>
                    <td>${data.complianceRate}%</td>
                `;
                
                documentationTableBody.appendChild(row);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        function updateCharts(errorCount, successCount, criteriaData, documentationData, selectedValue, errorsByCode) {
            // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
            const codes = Object.keys(errorsByCode);
            const errorValues = Object.values(errorsByCode);
            
            // –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            if (pieChart) pieChart.destroy();
            const pieCtx = document.getElementById('pieChart').getContext('2d');
            pieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: ['–° –æ—à–∏–±–∫–∞–º–∏', '–£—Å–ø–µ—à–Ω—ã–µ'],
                    datasets: [{
                        data: [errorCount, successCount],
                        backgroundColor: ['#e74c3c', '#2ecc71']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –∫–∞—á–µ—Å—Ç–≤—É'
                        }
                    }
                }
            });
            
            // –°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ - –æ—à–∏–±–∫–∏ –ø–æ –∫–æ–¥–∞–º –ú–ö–ë
            if (barChart) barChart.destroy();
            const barCtx = document.getElementById('barChart').getContext('2d');
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: codes,
                    datasets: [{
                        label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫',
                        data: errorValues,
                        backgroundColor: '#3498db'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '–û—à–∏–±–∫–∏ –ø–æ –∫–æ–¥–∞–º –ú–ö–ë-10'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫'
                            }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞
            if (criteriaPerformanceChart) criteriaPerformanceChart.destroy();
            const criteriaCtx = document.getElementById('criteriaPerformanceChart').getContext('2d');
            
            const criteriaLabels = qualityCriteria;
            const criteriaRates = qualityCriteria.map(criterion => criteriaData[criterion].complianceRate);
            
            criteriaPerformanceChart = new Chart(criteriaCtx, {
                type: 'bar',
                data: {
                    labels: criteriaLabels.map(label => {
                        // –°–æ–∫—Ä–∞—â–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        return label.length > 30 ? label.substring(0, 30) + '...' : label;
                    }),
                    datasets: [{
                        label: '% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è',
                        data: criteriaRates,
                        backgroundColor: '#9b59b6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: '–ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è'
                            }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
            if (documentationQualityChart) documentationQualityChart.destroy();
            const docCtx = document.getElementById('documentationQualityChart').getContext('2d');
            
            const docLabels = documentationCriteria;
            const docRates = documentationCriteria.map(criterion => documentationData[criterion].complianceRate);
            
            documentationQualityChart = new Chart(docCtx, {
                type: 'bar',
                data: {
                    labels: docLabels.map(label => {
                        // –°–æ–∫—Ä–∞—â–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        return label.length > 30 ? label.substring(0, 30) + '...' : label;
                    }),
                    datasets: [{
                        label: '% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è',
                        data: docRates,
                        backgroundColor: '#e67e22'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '–ö–∞—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: '–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è'
                            }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            if (documentsDynamicChart) documentsDynamicChart.destroy();
            const documentsDynamicCtx = document.getElementById('documentsDynamicChart').getContext('2d');
            
            let documentsTitle, documentsLabels, documentsData;
            
            if (selectedValue === "year") {
                // –ó–∞ –≥–æ–¥ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ –º–µ—Å—è—Ü–∞–º
                documentsTitle = '–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º';
                documentsLabels = monthlyData.labels;
                documentsData = monthlyData.documents;
            } else {
                // –ó–∞ –º–µ—Å—è—Ü - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ –Ω–µ–¥–µ–ª—è–º
                documentsTitle = '–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –Ω–µ–¥–µ–ª—è–º';
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–µ–¥–µ–ª—è–º
                const monthData = generateWeeklyData(totalDocuments, totalErrors);
                documentsLabels = monthData.labels;
                documentsData = monthData.documents;
            }
            
            documentsDynamicChart = new Chart(documentsDynamicCtx, {
                type: 'line',
                data: {
                    labels: documentsLabels,
                    datasets: [{
                        label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
                        data: documentsData,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: documentsTitle
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤'
                            }
                        }
                    }
                }
            });
            
            // –ì—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—à–∏–±–æ–∫
            if (errorsDynamicChart) errorsDynamicChart.destroy();
            const errorsDynamicCtx = document.getElementById('errorsDynamicChart').getContext('2d');
            
            let errorsTitle, errorsLabels, errorsData;
            
            if (selectedValue === "year") {
                // –ó–∞ –≥–æ–¥ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ –º–µ—Å—è—Ü–∞–º
                errorsTitle = '–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—à–∏–±–æ–∫ –ø–æ –º–µ—Å—è—Ü–∞–º';
                errorsLabels = monthlyData.labels;
                errorsData = monthlyData.errorRates;
            } else {
                // –ó–∞ –º–µ—Å—è—Ü - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ –Ω–µ–¥–µ–ª—è–º
                errorsTitle = '–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—à–∏–±–æ–∫ –ø–æ –Ω–µ–¥–µ–ª—è–º';
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–µ–¥–µ–ª—è–º
                const monthData = generateWeeklyData(totalDocuments, totalErrors);
                errorsLabels = monthData.labels;
                errorsData = monthData.errorRates;
            }
            
            errorsDynamicChart = new Chart(errorsDynamicCtx, {
                type: 'line',
                data: {
                    labels: errorsLabels,
                    datasets: [{
                        label: selectedValue === "year" ? '–ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫' : '–ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫',
                        data: errorsData,
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: errorsTitle
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: selectedValue === "year" ? 20 : 15,
                            title: {
                                display: true,
                                text: '–ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ (%)'
                            }
                        }
                    }
                }
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞
        function generateReport() {
            const query = aiQuery.value.trim();
            
            if (!query) {
                aiResponse.innerHTML = '<p style="color: red;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞.</p>';
                return;
            }
            
            // –£–Ω–∏—á—Ç–æ–∂–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã AI
            aiCharts.forEach(chart => chart.destroy());
            aiCharts = [];
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
            const direction = detectDirection(query);
            const directionData = medicalDirections[direction];
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—è—Ü–µ–≤ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
            const monthsCount = detectMonths(query);
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Å—è—Ü–µ–≤
            const totalDocs = directionData.monthlyDocs * monthsCount;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            const errorRate = Math.floor(Math.random() * 
                (directionData.errorRate.max - directionData.errorRate.min + 1)) + 
                directionData.errorRate.min;
            const errorCount = Math.round(totalDocs * errorRate / 100);
            const successCount = totalDocs - errorCount;
            
            const criteriaData = generateCriteriaData(totalDocs, direction);
            const documentationData = generateDocumentationData(totalDocs, direction);
            
            // –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—ã–π –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π
            let worstCriterion = "";
            let worstRate = 100;
            
            for (const criterion in criteriaData) {
                if (criteriaData[criterion].complianceRate < worstRate) {
                    worstRate = criteriaData[criterion].complianceRate;
                    worstCriterion = criterion;
                }
            }
            
            // –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—ã–π –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
            let worstDocCriterion = "";
            let worstDocRate = 100;
            
            for (const criterion in documentationData) {
                if (documentationData[criterion].complianceRate < worstDocRate) {
                    worstDocRate = documentationData[criterion].complianceRate;
                    worstDocCriterion = criterion;
                }
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ä–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            const avgCriteriaRate = Math.round(Object.values(criteriaData).reduce((sum, item) => sum + item.complianceRate, 0) / Object.keys(criteriaData).length);
            const avgDocumentationRate = Math.round(Object.values(documentationData).reduce((sum, item) => sum + item.complianceRate, 0) / Object.keys(documentationData).length);
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
            aiResponse.innerHTML = `
                <h3>–û—Ç—á–µ—Ç –ø–æ ${directionData.title} –∑–∞ ${monthsCount} ${monthsCount === 1 ? '–º–µ—Å—è—Ü' : monthsCount < 5 ? '–º–µ—Å—è—Ü–∞' : '–º–µ—Å—è—Ü–µ–≤'}</h3>
                <p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏:</strong> ${directionData.criteriaParagraph} –ü—Ä–∏–∫–∞–∑–∞ 203–ù</p>
                
                <div class="ai-charts">
                    <div class="ai-chart-container">
                        <h4>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                        <canvas id="aiOverallChart"></canvas>
                    </div>
                    <div class="ai-chart-container">
                        <h4>–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞</h4>
                        <canvas id="aiCriteriaChart"></canvas>
                    </div>
                    <div class="ai-chart-container">
                        <h4>–ö–∞—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</h4>
                        <canvas id="aiDocumentationChart"></canvas>
                    </div>
                </div>
                
                <h4>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h4>
                <ul>
                    <li>–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: ${totalDocs.toLocaleString('ru-RU')}</li>
                    <li>–î–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏: ${errorCount.toLocaleString('ru-RU')} (${errorRate}%)</li>
                    <li>–£—Å–ø–µ—à–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: ${successCount.toLocaleString('ru-RU')} (${100 - errorRate}%)</li>
                </ul>
                
                <h4>–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞:</h4>
                <ul>
                    <li>–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤: ${avgCriteriaRate}%</li>
                    <li>–ù–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π: "${worstCriterion}" (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ ${worstRate}% —Å–ª—É—á–∞–µ–≤)</li>
                    <li>–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è ${directionData.title}: ${directionData.specificCriteria.slice(0, 3).join(", ")}</li>
                </ul>
                
                <h4>–ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:</h4>
                <ul>
                    <li>–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: ${avgDocumentationRate}%</li>
                    <li>–ù–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∞—Å–ø–µ–∫—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: "${worstDocCriterion}" (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤ ${worstDocRate}% —Å–ª—É—á–∞–µ–≤)</li>
                </ul>
                
                <h4>–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:</h4>
                <ul>
                    ${directionData.commonProblems.map(problem => `<li>${problem}</li>`).join('')}
                </ul>
                
                <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h4>
                <ul>
                    <li>–ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</li>
                    <li>–í–Ω–µ–¥—Ä–∏—Ç—å —á–µ–∫-–ª–∏—Å—Ç—ã –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</li>
                    <li>–£—Å–∏–ª–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —Å—Ç–∞—Ä—à–µ–≥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞</li>
                    <li>–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ</li>
                </ul>
            `;
            
            // –°–æ–∑–¥–∞–µ–º –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –æ—Ç—á–µ—Ç–∞ AI
            setTimeout(() => {
                // –î–∏–∞–≥—Ä–∞–º–º–∞ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                const overallCtx = document.getElementById('aiOverallChart').getContext('2d');
                const overallChart = new Chart(overallCtx, {
                    type: 'pie',
                    data: {
                        labels: ['–° –æ—à–∏–±–∫–∞–º–∏', '–£—Å–ø–µ—à–Ω—ã–µ'],
                        datasets: [{
                            data: [errorCount, successCount],
                            backgroundColor: ['#e74c3c', '#2ecc71']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                aiCharts.push(overallChart);
                
                // –î–∏–∞–≥—Ä–∞–º–º–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∫–∞—á–µ—Å—Ç–≤–∞
                const criteriaCtx = document.getElementById('aiCriteriaChart').getContext('2d');
                const criteriaChart = new Chart(criteriaCtx, {
                    type: 'pie',
                    data: {
                        labels: ['–í—ã–ø–æ–ª–Ω–µ–Ω–æ', '–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ'],
                        datasets: [{
                            data: [avgCriteriaRate, 100 - avgCriteriaRate],
                            backgroundColor: ['#2ecc71', '#e74c3c']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                aiCharts.push(criteriaChart);
                
                // –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
                const documentationCtx = document.getElementById('aiDocumentationChart').getContext('2d');
                const documentationChart = new Chart(documentationCtx, {
                    type: 'pie',
                    data: {
                        labels: ['–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç', '–ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç'],
                        datasets: [{
                            data: [avgDocumentationRate, 100 - avgDocumentationRate],
                            backgroundColor: ['#2ecc71', '#e74c3c']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                aiCharts.push(documentationChart);
            }, 100);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
        });
    </script>
</body>
</html>